#!/usr/bin/env bash
# Get the hostname
var=$(hostname)

# Define the string for adding the custom header and rewrite rule
string="server {\n\tadd_header X-Served-By $var;\n\trewrite ^/redirect_me https://www.youtube.com/watch?v=QH2-TGUlwu4 permanent;"

# Update package lists and install Nginx
sudo apt-get update -y
sudo apt-get install nginx -y

# Create index.html and custom_404.html
echo "Hello World!" | sudo tee /usr/share/nginx/html/index.html > /dev/null
echo "Ceci n'est pas une page" | sudo tee /var/www/html/custom_404.html > /dev/null

# Update Nginx configuration to add custom header and rewrite rule
sudo sed -i "/^server {/a $string" /etc/nginx/sites-available/default

# Start Nginx service
sudo service nginx restart

